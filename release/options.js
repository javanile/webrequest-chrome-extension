function setFileError(e){var t=document.getElementById("statusIcon");t.textContent=e,window.setTimeout(function(){t.textContent=""},5e3)}function handleFileSelect(e){"use strict";var t=e.target.files,n=t[0];if(t&&n){var o=document.getElementById("iconImage");if(o.setAttribute("src",DEFAULT_ICON),n.size>FILE_SIZE_LIMIT)return setFileError("File size limit exceeded (max 100KB)"),void(e.srcElement.value="");if(FILE_TYPES.indexOf(n.type)===-1)return setFileError("Invalid file type (JPEG or PNG)"),void(e.srcElement.value="");var i=new FileReader;i.onload=function(e){var t=e.target.result,n="data:image/png;base64,"+window.btoa(t);o.setAttribute("src",n)},i.readAsBinaryString(n)}}function validateOptions(){var e=document.getElementById("customUrl").value,t=document.getElementById("domain").value,n=document.getElementById("notification").checked,o=document.getElementById("notificationTitle").value,i=document.getElementById("notificationText").value,c=!0;return e.length>1024&&(c=!1),t.length>1024&&(c=!1),n===!0&&(i.length>256||o.length>256)&&(c=!1),c}function saveOptions(){"use strict";var e=0,t=document.getElementById("customUrl").value,n=-1,o=document.getElementById("domain").value,i=document.getElementById("onlyHostname").checked,c=document.getElementById("iconImage").src,d=document.getElementById("notification").checked,r=document.getElementById("notificationTitle").value,l=document.getElementById("notificationText").value,a=document.getElementsByName("mode");for(e=0;e<a.length;e++)if(a[e].checked){n=e;break}if(validateOptions()===!0){var m={};for(m.customUrl=t,m.mode=n,m.domain=o,m.onlyHostname=i,m.notification={show:d,title:r,text:l},e=0;e<ICON_MAX_KEYS;e++)m["icon"+e]="";var s=ITEM_BYTES_LIMIT-"iconxx".length-4,u=new RegExp(".{1,"+s+"}","g"),g=c.match(u);for(e=0;e<ICON_MAX_KEYS&&e<g.length;e++)void 0!==g[e]&&(m["icon"+e]=g[e]);chrome.storage.sync.set(m,function(){var e=document.getElementById("status");e.textContent="Options saved",void 0!==chrome.runtime.lastError&&(console.error("An error ocurred saving options: "+chrome.runtime.lastError.string),console.error(chrome.runtime.lastError),e.textContent="An error ocurred saving options"),window.setTimeout(function(){e.textContent=""},1800)})}}function restoreOptions(){"use strict";var e={};e.customUrl="https://duckduckgo.com/",e.mode=0,e.domain=".*",e.onlyHostname=!1,e.notification={show:!1,title:"Curtom Button",text:"URL doesn't match"};for(var t=0;t<ICON_MAX_KEYS;t++)e["icon"+t]="";e.icon0=DEFAULT_ICON,chrome.storage.sync.get(e,function(e){if(void 0!==chrome.runtime.lastError)return void console.error("An error ocurred restoring options: "+chrome.runtime.lastError);document.getElementById("customUrl").value=e.customUrl,document.getElementById("domain").value=e.domain,document.getElementById("onlyHostname").checked=e.onlyHostname,document.getElementsByName("mode")[e.mode].checked=!0;for(var t="",n=0;n<ICON_MAX_KEYS;n++)t+=e["icon"+n];document.getElementById("iconImage").src=t,document.getElementById("notification").checked=e.notification.show,document.getElementById("notificationTitle").value=e.notification.title,document.getElementById("notificationText").value=e.notification.text,e.notification.show===!0&&(document.getElementById("notificationOptions").style.display="block")})}function resetDomain(){"use strict";document.getElementById("domain").value=".*"}function resetIcon(){"use strict";document.getElementById("iconImage").src=DEFAULT_ICON}function resetNotification(){"use strict";document.getElementById("notificationTitle").value="Custom Button",document.getElementById("notificationText").value="URL doesn't match"}function toggleNotificationOptions(){"use strict";var e=document.getElementById("notificationOptions");""===e.style.display||"none"===e.style.display?e.style.display="block":e.style.display="none"}document.addEventListener("DOMContentLoaded",restoreOptions),document.getElementById("save").addEventListener("click",saveOptions),document.getElementById("iconFilePicker").addEventListener("change",handleFileSelect,!1),document.getElementById("notification").addEventListener("change",toggleNotificationOptions),document.getElementById("domainRestore").addEventListener("click",resetDomain),document.getElementById("notificationRestore").addEventListener("click",resetNotification),document.getElementById("iconRestore").addEventListener("click",resetIcon),window.File&&window.FileReader&&window.FileList&&window.Blob?document.getElementById("iconFilePicker").addEventListener("change",handleFileSelect,!1):console.log("The File APIs are not fully supported in this browser.");